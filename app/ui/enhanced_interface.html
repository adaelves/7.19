<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频下载器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 配置Tailwind自定义颜色和字体 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0071e3',
                        secondary: '#34c759',
                        warning: '#ff9500',
                        danger: '#ff3b30',
                        macos: {
                            titlebar: '#e8e8e8',
                            window: '#f2f2f7',
                            button: {
                                red: '#ff5f56',
                                yellow: '#ffbd2e',
                                green: '#27c93f'
                            },
                            active: '#0071e3',
                            hover: '#d1d1d6',
                            focus: '#0051cc'
                        },
                        status: {
                            completed: '#e6fffa',
                            paused: '#fff7e6',
                            failed: '#ffebee'
                        }
                    },
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .macos-titlebar {
                -webkit-app-region: drag;
            }
            .macos-button {
                -webkit-app-region: no-drag;
            }
            .window-shadow {
                box-shadow: 0 10px 50px rgba(0, 0, 0, 0.2);
            }
            .download-progress {
                background: linear-gradient(90deg, #0071e3 var(--progress), transparent 0);
            }
            .button-hover {
                @apply hover:bg-gray-100 transition-colors duration-200;
            }
            .modal-transition {
                @apply transition-all duration-300 ease-in-out;
            }
            .btn-tab {
                @apply px-4 py-1.5 text-sm rounded-md shadow-sm hover:bg-gray-100 transition-all;
            }
            .btn-tab-active {
                @apply bg-gray-200 font-medium;
            }
            .draggable {
                cursor: grab;
            }
            .dragging {
                cursor: grabbing;
                opacity: 0.8;
                transform: scale(1.02);
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                z-index: 10;
            }
            .resize-handle {
                position: absolute;
                bottom: 0;
                right: 0;
                width: 15px;
                height: 15px;
                cursor: nwse-resize;
                z-index: 20;
            }
            .platform-icon {
                width: 16px;
                height: 16px;
                margin-right: 4px;
            }
            .task-menu {
                display: none;
                position: absolute;
                background-color: white;
                border-radius: 4px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                padding: 4px 0;
                z-index: 50;
                min-width: 120px;
            }
            .task-menu-item {
                padding: 6px 16px;
                cursor: pointer;
                font-size: 14px;
                color: #333;
            }
            .task-menu-item:hover {
                background-color: #f5f5f5;
            }
            .fixed-status {
                position: sticky;
                bottom: 0;
                z-index: 10;
            }
            .creator-table-row {
                @apply hover:bg-gray-50 transition-colors cursor-pointer;
            }
            .creator-table-row-dragging {
                @apply opacity-80 transform scale-105 shadow-md z-10;
            }
        }
    </style>
    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
</head>
<body class="bg-gray-100 font-sans antialiased">
    <!-- 主窗口容器 -->
    <div id="mainWindow" class="relative mx-auto mt-10 w-[900px] h-[600px] rounded-xl overflow-hidden window-shadow bg-white flex flex-col">
        
        <!-- macOS风格标题栏 - 调整为macOS原生风格的浅灰色 -->
        <div class="macos-titlebar bg-macos-titlebar h-10 flex items-center justify-between px-4 border-b border-gray-300">
            <!-- 窗口控制按钮 - 更精确的macOS风格颜色 -->
            <div class="flex space-x-2">
                <button class="macos-button w-5 h-5 rounded-full bg-macos-button-red flex items-center justify-center hover:bg-opacity-80 transition-colors">
                    <i class="fa fa-times text-xs text-transparent hover:text-black/30"></i>
                </button>
                <button class="macos-button w-5 h-5 rounded-full bg-macos-button-yellow flex items-center justify-center hover:bg-opacity-80 transition-colors">
                    <i class="fa fa-minus text-xs text-transparent hover:text-black/30"></i>
                </button>
                <button class="macos-button w-5 h-5 rounded-full bg-macos-button-green flex items-center justify-center hover:bg-opacity-80 transition-colors">
                    <i class="fa fa-plus text-xs text-transparent hover:text-black/30"></i>
                </button>
            </div>
            
            <!-- 窗口标题 -->
            <div class="text-gray-700 text-sm font-medium">视频下载器</div>
            
            <!-- 菜单按钮 -->
            <div class="text-gray-700 text-xs opacity-70">
                <i class="fa fa-chevron-down"></i>
            </div>
        </div>
        
        <!-- 顶部导航按钮 - 合并与标题栏的视觉分隔 -->
        <div class="flex justify-center py-1.5 px-4 bg-macos-titlebar">
            <button id="historyBtn" class="btn-tab btn-tab-active flex items-center">
                <i class="fa fa-history mr-1.5"></i> 历史记录
            </button>
            <button id="creatorBtn" class="btn-tab ml-1 flex items-center">
                <i class="fa fa-eye mr-1.5"></i> 创作者监控
            </button>
            <button id="settingsBtn" class="btn-tab ml-1 flex items-center">
                <i class="fa fa-cog mr-1.5"></i> 首选项
            </button>
        </div>
        
        <!-- 搜索和添加区域 - 添加"添加队列"按钮 -->
        <div class="p-2 border-b border-gray-200 bg-white">
            <div class="flex items-center space-x-2">
                <div class="relative flex-1">
                    <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    <input type="text" placeholder="搜索视频或粘贴链接" class="w-full pl-10 pr-4 py-1.5 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all text-sm">
                </div>
                <div class="flex space-x-1.5">
                    <button class="bg-primary hover:bg-primary/90 text-white px-3 py-1.5 rounded-lg transition-colors flex items-center text-sm">
                        <i class="fa fa-plus mr-1"></i>
                        <span>添加下载</span>
                    </button>
                    <button class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg transition-colors flex items-center text-sm">
                        <i class="fa fa-list mr-1"></i>
                        <span>添加队列</span>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- 下载列表 - 使用flex-1使状态栏固定在底部 -->
        <div class="flex-1 overflow-y-auto bg-white">
            <div class="p-2">
                <div class="text-sm font-medium text-gray-700 mb-2 px-2">正在下载</div>
                
                <!-- 下载项 1 - 缩略图高度增加 -->
                <div class="task-card bg-white border border-gray-200 hover:border-gray-300 transition-all shadow-sm draggable" draggable="true" data-status="downloading">
                    <div class="flex items-start p-2">
                        <img src="https://picsum.photos/seed/video1/120/80" alt="视频缩略图" class="w-32 h-20 object-cover rounded">
                        <div class="ml-2 flex-1">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm font-medium text-gray-900 truncate">Python编程教程 - 从入门到精通</h3>
                            </div>
                            <div class="flex justify-between items-center mt-1">
                                <div class="flex-1 bg-gray-200 rounded-full h-1.5 mr-2">
                                    <div class="download-progress h-1.5 rounded-full" style="--progress: 78%"></div>
                                </div>
                                <span class="text-xs text-gray-500 ml-2 whitespace-nowrap">78%</span>
                                <div class="flex space-x-1 ml-2">
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-pause"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-times"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-folder-open-o"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                                <span>99.8 MB/128.5 MB</span>
                                <span>剩余时间: 00:23</span>
                                <span>1.2 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 下载项 2 - 缩略图高度增加 -->
                <div class="task-card bg-white border-x border-b border-gray-200 hover:border-gray-300 transition-all shadow-sm draggable" draggable="true" data-status="downloading">
                    <div class="flex items-start p-2">
                        <img src="https://picsum.photos/seed/video2/120/80" alt="视频缩略图" class="w-32 h-20 object-cover rounded">
                        <div class="ml-2 flex-1">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm font-medium text-gray-900 truncate">Web开发实战 - React框架详解</h3>
                            </div>
                            <div class="flex justify-between items-center mt-1">
                                <div class="flex-1 bg-gray-200 rounded-full h-1.5 mr-2">
                                    <div class="download-progress h-1.5 rounded-full" style="--progress: 45%"></div>
                                </div>
                                <span class="text-xs text-gray-500 ml-2 whitespace-nowrap">45%</span>
                                <div class="flex space-x-1 ml-2">
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-pause"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-times"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-folder-open-o"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                                <span>115.3 MB/256.3 MB</span>
                                <span>剩余时间: 01:02</span>
                                <span>2.4 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 频道下载项 - 显示已下载数/总视频数 -->
                <div class="task-card bg-white border-x border-b border-gray-200 hover:border-gray-300 transition-all shadow-sm draggable" draggable="true" data-status="downloading">
                    <div class="flex items-start p-2">
                        <img src="https://picsum.photos/seed/channel1/120/80" alt="频道缩略图" class="w-32 h-20 object-cover rounded">
                        <div class="ml-2 flex-1">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm font-medium text-gray-900 truncate">[Channel] 技术宅小明</h3>
                            </div>
                            <div class="flex justify-between items-center mt-1">
                                <div class="flex-1 bg-gray-200 rounded-full h-1.5 mr-2">
                                    <div class="download-progress h-1.5 rounded-full" style="--progress: 40%"></div>
                                </div>
                                <span class="text-xs text-gray-500 ml-2 whitespace-nowrap">5/20</span>
                                <div class="flex space-x-1 ml-2">
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-pause"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-times"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-folder-open-o"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                                <span>1.3 GB/3.2 GB</span>
                                <span>剩余时间: 08:45</span>
                                <span>1.8 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 已暂停的下载项 - 缩略图高度增加 -->
                <div class="task-card bg-status-paused border-x border-b border-gray-200 hover:border-gray-300 transition-all shadow-sm draggable" draggable="true" data-status="paused">
                    <div class="flex items-start p-2">
                        <img src="https://picsum.photos/seed/video4/120/80" alt="视频缩略图" class="w-32 h-20 object-cover rounded">
                        <div class="ml-2 flex-1">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm font-medium text-gray-900 truncate">机器学习入门 - 神经网络基础</h3>
                            </div>
                            <div class="flex justify-between items-center mt-1">
                                <div class="flex-1 bg-gray-200 rounded-full h-1.5 mr-2">
                                    <div class="download-progress h-1.5 rounded-full" style="--progress: 33%"></div>
                                </div>
                                <span class="text-xs text-orange-500 ml-2 whitespace-nowrap">33%</span>
                                <div class="flex space-x-1 ml-2">
                                    <button class="text-primary hover:text-primary/80 p-1.5 text-sm">
                                        <i class="fa fa-play"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-times"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-folder-open-o"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                                <span>62.4 MB/189.2 MB</span>
                                <span>已暂停</span>
                                <span>0.0 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 已完成的下载项 - 缩略图高度增加 -->
                <div class="task-card bg-status-completed border-x border-b border-gray-200 hover:border-gray-300 transition-all shadow-sm draggable" draggable="true" data-status="completed">
                    <div class="flex items-start p-2">
                        <img src="https://picsum.photos/seed/video5/120/80" alt="视频缩略图" class="w-32 h-20 object-cover rounded">
                        <div class="ml-2 flex-1">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm font-medium text-gray-900 truncate">数据结构与算法 - 高级篇</h3>
                            </div>
                            <div class="flex justify-between items-center mt-1">
                                <div class="flex-1 bg-gray-200 rounded-full h-1.5 mr-2">
                                    <div class="download-progress h-1.5 rounded-full" style="--progress: 100%"></div>
                                </div>
                                <span class="text-xs text-green-500 ml-2 whitespace-nowrap">100%</span>
                                <div class="flex space-x-1 ml-2">
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-play"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-times"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-folder-open-o"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                                <span>320.7 MB/320.7 MB</span>
                                <span>已完成</span>
                                <span>3.5 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 下载失败的下载项 - 缩略图高度增加 -->
                <div class="task-card bg-status-failed border-x border-b border-gray-200 hover:border-gray-300 transition-all shadow-sm draggable" draggable="true" data-status="failed">
                    <div class="flex items-start p-2">
                        <img src="https://picsum.photos/seed/video6/120/80" alt="视频缩略图" class="w-32 h-20 object-cover rounded">
                        <div class="ml-2 flex-1">
                            <div class="flex justify-between items-center">
                                <h3 class="text-sm font-medium text-gray-900 truncate">前端工程化实战教程</h3>
                            </div>
                            <div class="flex justify-between items-center mt-1">
                                <div class="flex-1 bg-gray-200 rounded-full h-1.5 mr-2">
                                    <div class="download-progress h-1.5 rounded-full" style="--progress: 65%"></div>
                                </div>
                                <span class="text-xs text-red-500 ml-2 whitespace-nowrap">65%</span>
                                <div class="flex space-x-1 ml-2">
                                    <button class="text-primary hover:text-primary/80 p-1.5 text-sm">
                                        <i class="fa fa-refresh"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-times"></i>
                                    </button>
                                    <button class="text-gray-400 hover:text-gray-600 p-1.5 text-sm">
                                        <i class="fa fa-folder-open-o"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                                <span>140.0 MB/215.4 MB</span>
                                <span>下载失败</span>
                                <span>0.0 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 状态栏 - 固定在底部 -->
        <div class="bg-white border-t border-gray-200 py-1.5 px-3 flex justify-between items-center text-xs text-gray-500 fixed-status">
            <div class="flex items-center flex-wrap">
                <span>总计: 6 个下载</span>
                <span class="mx-1.5">•</span>
                <span>活动: 3 个</span>
                <span class="mx-1.5">•</span>
                <span>暂停: 1 个</span>
                <span class="mx-1.5">•</span>
                <span>已完成: 1 个</span>
                <span class="mx-1.5">•</span>
                <span>失败: 1 个</span>
            </div>
            <div class="flex items-center">
                <button class="hover:text-primary">全部暂停</button>
                <span class="mx-1.5">|</span>
                <button class="hover:text-primary">全部开始</button>
            </div>
        </div>
        
        <!-- 调整大小手柄 -->
        <div class="resize-handle bg-gray-300 opacity-0 hover:opacity-100 transition-opacity"></div>
    </div>
    
    <!-- 右键菜单 -->
    <div id="taskMenu" class="task-menu">
        <div class="task-menu-item" data-action="start">开始</div>
        <div class="task-menu-item" data-action="pause">暂停</div>
        <div class="task-menu-item" data-action="cancel">取消</div>
        <div class="task-menu-item" data-action="delete">删除</div>
        <div class="task-menu-item" data-action="restart">重新开始</div>
        <div class="task-menu-item" data-action="delete-completed">删除已完成任务</div>
    </div>
    
    <!-- 历史记录模态框 (默认隐藏) -->
    <div id="historyModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden modal-transition">
        <div class="bg-white rounded-lg w-96 shadow-xl transform transition-all scale-95 opacity-0">
            <div class="flex items-center justify-between p-3 border-b border-gray-200">
                <h3 class="font-medium text-gray-900">下载历史</h3>
                <button class="closeModal text-gray-400 hover:text-gray-500">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="p-3 max-h-[400px] overflow-y-auto">
                <!-- 历史记录项 -->
                <div class="flex items-center p-2 mb-2 rounded-md hover:bg-gray-50">
                    <img src="https://picsum.photos/seed/history1/60/34" alt="历史视频缩略图" class="w-16 h-9 object-cover rounded">
                    <div class="ml-2 flex-1">
                        <h4 class="text-sm font-medium text-gray-900 truncate">Python基础教程 - 变量与数据类型</h4>
                        <div class="flex flex-wrap text-xs text-gray-500 mt-0.5 gap-x-2 gap-y-1">
                            <span class="flex items-center"><i class="fa fa-user-o mr-1"></i> 技术宅小明</span>
                            <span class="flex items-center"><i class="fa fa-play-circle-o mr-1"></i> Bilibili</span>
                            <span class="flex items-center"><i class="fa fa-file-o mr-1"></i> 128.5 MB</span>
                            <span class="flex items-center"><i class="fa fa-calendar-o mr-1"></i> 2023-06-15</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center p-2 mb-2 rounded-md hover:bg-gray-50">
                    <img src="https://picsum.photos/seed/history2/60/34" alt="历史视频缩略图" class="w-16 h-9 object-cover rounded">
                    <div class="ml-2 flex-1">
                        <h4 class="text-sm font-medium text-gray-900 truncate">JavaScript异步编程 - Promise详解</h4>
                        <div class="flex flex-wrap text-xs text-gray-500 mt-0.5 gap-x-2 gap-y-1">
                            <span class="flex items-center"><i class="fa fa-user-o mr-1"></i> 前端老司机</span>
                            <span class="flex items-center"><i class="fa fa-play-circle-o mr-1"></i> Youku</span>
                            <span class="flex items-center"><i class="fa fa-file-o mr-1"></i> 256.3 MB</span>
                            <span class="flex items-center"><i class="fa fa-calendar-o mr-1"></i> 2023-06-12</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center p-2 mb-2 rounded-md hover:bg-gray-50">
                    <img src="https://picsum.photos/seed/history3/60/34" alt="历史视频缩略图" class="w-16 h-9 object-cover rounded">
                    <div class="ml-2 flex-1">
                        <h4 class="text-sm font-medium text-gray-900 truncate">React Hooks完全指南</h4>
                        <div class="flex flex-wrap text-xs text-gray-500 mt-0.5 gap-x-2 gap-y-1">
                            <span class="flex items-center"><i class="fa fa-user-o mr-1"></i> 前端开发教程</span>
                            <span class="flex items-center"><i class="fa fa-play-circle-o mr-1"></i> 腾讯视频</span>
                            <span class="flex items-center"><i class="fa fa-file-o mr-1"></i> 320.7 MB</span>
                            <span class="flex items-center"><i class="fa fa-calendar-o mr-1"></i> 2023-06-10</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center p-2 mb-2 rounded-md hover:bg-gray-50">
                    <img src="https://picsum.photos/seed/history4/60/34" alt="历史视频缩略图" class="w-16 h-9 object-cover rounded">
                    <div class="ml-2 flex-1">
                        <h4 class="text-sm font-medium text-gray-900 truncate">Vue3 Composition API实战</h4>
                        <div class="flex flex-wrap text-xs text-gray-500 mt-0.5 gap-x-2 gap-y-1">
                            <span class="flex items-center"><i class="fa fa-user-o mr-1"></i> 全栈开发秘籍</span>
                            <span class="flex items-center"><i class="fa fa-play-circle-o mr-1"></i> 爱奇艺</span>
                            <span class="flex items-center"><i class="fa fa-file-o mr-1"></i> 189.2 MB</span>
                            <span class="flex items-center"><i class="fa fa-calendar-o mr-1"></i> 2023-06-08</span>
                        </div>
                    </div>
                </div>
                <div class="flex items-center p-2 mb-2 rounded-md hover:bg-gray-50">
                    <img src="https://picsum.photos/seed/history5/60/34" alt="历史视频缩略图" class="w-16 h-9 object-cover rounded">
                    <div class="ml-2 flex-1">
                        <h4 class="text-sm font-medium text-gray-900 truncate">Node.js实战开发 - REST API构建</h4>
                        <div class="flex flex-wrap text-xs text-gray-500 mt-0.5 gap-x-2 gap-y-1">
                            <span class="flex items-center"><i class="fa fa-user-o mr-1"></i> 后端架构师</span>
                            <span class="flex items-center"><i class="fa fa-play-circle-o mr-1"></i> Bilibili</span>
                            <span class="flex items-center"><i class="fa fa-file-o mr-1"></i> 245.8 MB</span>
                            <span class="flex items-center"><i class="fa fa-calendar-o mr-1"></i> 2023-06-05</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-200 flex justify-end">
                <button class="closeModal px-4 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-md text-sm">关闭</button>
            </div>
        </div>
    </div>
    
    <!-- 创作者监控模态框 (默认隐藏) -->
    <div id="creatorModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden modal-transition">
        <div class="bg-white rounded-lg w-96 shadow-xl transform transition-all scale-95 opacity-0">
            <div class="flex items-center justify-between p-3 border-b border-gray-200">
                <h3 class="font-medium text-gray-900">创作者监控</h3>
                <button class="closeModal text-gray-400 hover:text-gray-500">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="p-3 max-h-[400px] overflow-y-auto">
                <!-- 创作者监控搜索和操作栏 -->
                <div class="mb-3">
                    <div class="flex items-center justify-between mb-2">
                        <div class="relative flex-1 mr-2">
                            <i class="fa fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                            <input type="text" placeholder="搜索创作者" class="w-full pl-10 pr-4 py-1.5 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all text-sm">
                        </div>
                        <button class="px-3 py-1.5 bg-primary text-white hover:bg-primary/90 rounded-md text-sm flex items-center">
                            <i class="fa fa-plus mr-1"></i> 添加监控
                        </button>
                    </div>
                    <div class="flex justify-between items-center text-xs text-gray-500 mb-2">
                        <div>总计: 5 个创作者</div>
                        <div>
                            <button class="hover:text-primary">检查更新</button>
                            <span class="mx-1">|</span>
                            <button class="hover:text-primary">排序方式</button>
                        </div>
                    </div>
                </div>
                
                <!-- 创作者监控表格 -->
                <div class="bg-white rounded-md shadow-sm overflow-hidden">
                    <div class="table-responsive">
                        <table class="w-full">
                            <thead>
                                <tr class="text-xs text-gray-500 border-b border-gray-200">
                                    <th class="px-3 py-2 text-left font-medium">用户名</th>
                                    <th class="px-3 py-2 text-left font-medium">平台</th>
                                    <th class="px-3 py-2 text-left font-medium">总视频数</th>
                                    <th class="px-3 py-2 text-left font-medium">已下载</th>
                                    <th class="px-3 py-2 text-left font-medium">新内容</th>
                                    <th class="px-3 py-2 text-left font-medium">最近更新</th>
                                    <th class="px-3 py-2 text-left font-medium">操作</th>
                                </tr>
                            </thead>
                            <tbody id="creatorTable">
                                <!-- 创作者监控项 - 表格行 -->
                                <tr class="creator-table-row draggable" draggable="true" data-id="1">
                                    <td class="px-3 py-2">
                                        <div class="flex items-center">
                                            <img src="https://picsum.photos/seed/creator1/40/40" alt="创作者头像" class="w-6 h-6 rounded-full mr-2">
                                            <span class="text-sm">技术宅小明</span>
                                        </div>
                                    </td>
                                    <td class="px-3 py-2 text-sm">Bilibili</td>
                                    <td class="px-3 py-2 text-sm">23</td>
                                    <td class="px-3 py-2 text-sm">5</td>
                                    <td class="px-3 py-2 text-sm">
                                        <span class="bg-red-100 text-red-800 text-xs px-2 py-0.5 rounded-full">3</span>
                                    </td>
                                    <td class="px-3 py-2 text-sm">今天</td>
                                    <td class="px-3 py-2 text-sm">
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-refresh"></i>
                                        </button>
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-ellipsis-v"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="creator-table-row draggable" draggable="true" data-id="2">
                                    <td class="px-3 py-2">
                                        <div class="flex items-center">
                                            <img src="https://picsum.photos/seed/creator2/40/40" alt="创作者头像" class="w-6 h-6 rounded-full mr-2">
                                            <span class="text-sm">前端老司机</span>
                                        </div>
                                    </td>
                                    <td class="px-3 py-2 text-sm">Youku</td>
                                    <td class="px-3 py-2 text-sm">18</td>
                                    <td class="px-3 py-2 text-sm">3</td>
                                    <td class="px-3 py-2 text-sm">
                                        <span class="bg-red-100 text-red-800 text-xs px-2 py-0.5 rounded-full">2</span>
                                    </td>
                                    <td class="px-3 py-2 text-sm">昨天</td>
                                    <td class="px-3 py-2 text-sm">
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-refresh"></i>
                                        </button>
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-ellipsis-v"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="creator-table-row draggable" draggable="true" data-id="3">
                                    <td class="px-3 py-2">
                                        <div class="flex items-center">
                                            <img src="https://picsum.photos/seed/creator3/40/40" alt="创作者头像" class="w-6 h-6 rounded-full mr-2">
                                            <span class="text-sm">前端开发教程</span>
                                        </div>
                                    </td>
                                    <td class="px-3 py-2 text-sm">腾讯视频</td>
                                    <td class="px-3 py-2 text-sm">42</td>
                                    <td class="px-3 py-2 text-sm">8</td>
                                    <td class="px-3 py-2 text-sm">
                                        <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </td>
                                    <td class="px-3 py-2 text-sm">3天前</td>
                                    <td class="px-3 py-2 text-sm">
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-refresh"></i>
                                        </button>
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-ellipsis-v"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="creator-table-row draggable" draggable="true" data-id="4">
                                    <td class="px-3 py-2">
                                        <div class="flex items-center">
                                            <img src="https://picsum.photos/seed/creator4/40/40" alt="创作者头像" class="w-6 h-6 rounded-full mr-2">
                                            <span class="text-sm">全栈开发秘籍</span>
                                        </div>
                                    </td>
                                    <td class="px-3 py-2 text-sm">爱奇艺</td>
                                    <td class="px-3 py-2 text-sm">29</td>
                                    <td class="px-3 py-2 text-sm">6</td>
                                    <td class="px-3 py-2 text-sm">
                                        <span class="bg-red-100 text-red-800 text-xs px-2 py-0.5 rounded-full">1</span>
                                    </td>
                                    <td class="px-3 py-2 text-sm">2天前</td>
                                    <td class="px-3 py-2 text-sm">
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-refresh"></i>
                                        </button>
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-ellipsis-v"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="creator-table-row draggable" draggable="true" data-id="5">
                                    <td class="px-3 py-2">
                                        <div class="flex items-center">
                                            <img src="https://picsum.photos/seed/creator5/40/40" alt="创作者头像" class="w-6 h-6 rounded-full mr-2">
                                            <span class="text-sm">后端架构师</span>
                                        </div>
                                    </td>
                                    <td class="px-3 py-2 text-sm">Bilibili</td>
                                    <td class="px-3 py-2 text-sm">36</td>
                                    <td class="px-3 py-2 text-sm">12</td>
                                    <td class="px-3 py-2 text-sm">
                                        <span class="bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </td>
                                    <td class="px-3 py-2 text-sm">1个月前</td>
                                    <td class="px-3 py-2 text-sm">
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-refresh"></i>
                                        </button>
                                        <button class="text-gray-400 hover:text-gray-600 p-1">
                                            <i class="fa fa-ellipsis-v"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-200 flex justify-end">
                <button class="closeModal px-4 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-md text-sm">关闭</button>
            </div>
        </div>
    </div>
    
    <!-- 首选项模态框 (默认隐藏) -->
    <div id="settingsModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden modal-transition">
        <div class="bg-white rounded-lg w-96 shadow-xl transform transition-all scale-95 opacity-0">
            <div class="flex items-center justify-between p-3 border-b border-gray-200">
                <h3 class="font-medium text-gray-900">首选项</h3>
                <button class="closeModal text-gray-400 hover:text-gray-500">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="p-3 max-h-[400px] overflow-y-auto">
                <!-- 常规设置 -->
                <div class="mb-4">
                    <h4 class="text-sm font-medium text-gray-900 mb-2">常规设置</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">下载目录</label>
                                <div class="flex items-center mt-1">
                                    <input type="text" value="E:\test\6.25" class="w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    <button class="ml-2 px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-md text-sm">浏览</button>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">同时下载任务数</label>
                                <select class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    <option>1</option>
                                    <option selected="">3</option>
                                    <option>5</option>
                                    <option>10</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">下载完成后操作</label>
                                <select class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    <option selected="">无操作</option>
                                    <option>关机</option>
                                    <option>待机</option>
                                    <option>退出程序</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 网络设置 -->
                <div class="mb-4">
                    <h4 class="text-sm font-medium text-gray-900 mb-2">网络设置</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">最大连接数</label>
                                <input type="number" value="8" min="1" max="64" class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">下载速度限制 (KB/s)</label>
                                <div class="flex items-center mt-1">
                                    <input type="number" value="0" min="0" max="100000" class="w-full px-3 py-1 border border-gray-300 rounded-l-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    <span class="px-3 py-1 border border-l-0 border-gray-300 rounded-r-md text-sm bg-gray-50">0 = 无限制</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">使用代理服务器</label>
                                <div class="flex items-center mt-1">
                                    <input type="checkbox" id="useProxy" class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                    <label for="useProxy" class="ml-2 text-sm text-gray-700">启用</label>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between" id="proxySettings" style="display: none;">
                            <div class="w-full">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700">代理服务器</label>
                                        <input type="text" value="127.0.0.1" class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700">端口</label>
                                        <input type="number" value="1080" min="1" max="65535" class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <label class="block text-xs font-medium text-gray-700">需要认证</label>
                                    <div class="flex items-center mt-1">
                                        <input type="checkbox" id="proxyAuth" class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                        <label for="proxyAuth" class="ml-2 text-sm text-gray-700">启用</label>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-3 mt-3" id="proxyAuthSettings" style="display: none;">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700">用户名</label>
                                        <input type="text" class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-700">密码</label>
                                        <input type="password" class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 视频设置 -->
                <div class="mb-4">
                    <h4 class="text-sm font-medium text-gray-900 mb-2">视频设置</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">默认下载质量</label>
                                <select class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                    <option>自动选择</option>
                                    <option>1080p</option>
                                    <option selected="">700p</option>
                                    <option>480p</option>
                                    <option>360p</option>
                                </select>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">下载字幕</label>
                                <div class="flex items-center mt-1">
                                    <input type="checkbox" id="downloadSubtitles" class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary" checked>
                                    <label for="downloadSubtitles" class="ml-2 text-sm text-gray-700">启用</label>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">自动合并字幕</label>
                                <div class="flex items-center mt-1">
                                    <input type="checkbox" id="mergeSubtitles" class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                    <label for="mergeSubtitles" class="ml-2 text-sm text-gray-700">启用</label>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">视频重命名格式</label>
                                <input type="text" value="{title}_{creator}_{resolution}" class="mt-1 w-full px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary">
                                <div class="text-xs text-gray-500 mt-1">可用变量: {title}, {creator}, {id}, {resolution}, {date}</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 通知设置 -->
                <div>
                    <h4 class="text-sm font-medium text-gray-900 mb-2">通知设置</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">下载完成通知</label>
                                <div class="flex items-center mt-1">
                                    <input type="checkbox" id="completionNotification" class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary" checked>
                                    <label for="completionNotification" class="ml-2 text-sm text-gray-700">启用</label>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">下载失败通知</label>
                                <div class="flex items-center mt-1">
                                    <input type="checkbox" id="failureNotification" class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary" checked>
                                    <label for="failureNotification" class="ml-2 text-sm text-gray-700">启用</label>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="block text-xs font-medium text-gray-700">新视频可用通知</label>
                                <div class="flex items-center mt-1">
                                    <input type="checkbox" id="newVideoNotification" class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary" checked>
                                    <label for="newVideoNotification" class="ml-2 text-sm text-gray-700">启用</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="p-3 border-t border-gray-200 flex justify-end">
                <button class="closeModal mr-2 px-4 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-md text-sm">取消</button>
                <button class="px-4 py-1.5 bg-primary text-white hover:bg-primary/90 rounded-md text-sm">保存设置</button>
            </div>
        </div>
    </div>
    
    <script>
        // 模态框动画效果
        document.addEventListener('DOMContentLoaded', function() {
            // 模态框相关
            const modals = ['historyModal', 'creatorModal', 'settingsModal'];
            
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (!modal) return;
                
                // 打开模态框的按钮
                const openBtn = document.getElementById(modalId.replace('Modal', 'Btn'));
                if (openBtn) {
                    openBtn.addEventListener('click', () => {
                        modal.classList.remove('hidden');
                        setTimeout(() => {
                            modal.querySelector('div').classList.remove('scale-95', 'opacity-0');
                            modal.querySelector('div').classList.add('scale-100', 'opacity-100');
                        }, 10);
                    });
                }
                
                // 关闭模态框的按钮
                const closeBtns = modal.querySelectorAll('.closeModal');
                closeBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        modal.querySelector('div').classList.remove('scale-100', 'opacity-100');
                        modal.querySelector('div').classList.add('scale-95', 'opacity-0');
                        setTimeout(() => {
                            modal.classList.add('hidden');
                        }, 300);
                    });
                });
            });
            
            // 代理设置显示/隐藏
            const useProxy = document.getElementById('useProxy');
            const proxySettings = document.getElementById('proxySettings');
            
            if (useProxy && proxySettings) {
                useProxy.addEventListener('change', function() {
                    proxySettings.style.display = this.checked ? 'flex' : 'none';
                });
            }
            
            // 代理认证设置显示/隐藏
            const proxyAuth = document.getElementById('proxyAuth');
            const proxyAuthSettings = document.getElementById('proxyAuthSettings');
            
            if (proxyAuth && proxyAuthSettings) {
                proxyAuth.addEventListener('change', function() {
                    proxyAuthSettings.style.display = this.checked ? 'grid' : 'none';
                });
            }
            
            // 右键菜单
            const taskCards = document.querySelectorAll('.task-card, .creator-table-row');
            const taskMenu = document.getElementById('taskMenu');
            
            if (taskMenu) {
                taskCards.forEach(card => {
                    card.addEventListener('contextmenu', function(e) {
                        e.preventDefault();
                        
                        // 隐藏其他菜单
                        taskMenu.style.display = 'none';
                        
                        // 获取鼠标位置
                        const x = e.pageX;
                        const y = e.pageY;
                        
                        // 显示菜单
                        taskMenu.style.display = 'block';
                        taskMenu.style.left = `${x}px`;
                        taskMenu.style.top = `${y}px`;
                        
                        // 根据任务状态调整菜单项
                        const status = card.getAttribute('data-status');
                        const menuItems = taskMenu.querySelectorAll('.task-menu-item');
                        
                        menuItems.forEach(item => {
                            const action = item.getAttribute('data-action');
                            
                            // 根据状态隐藏某些菜单项
                            if (status === 'completed' && action === 'pause') {
                                item.style.display = 'none';
                            } else if (status === 'paused' && (action === 'pause' || action === 'delete-completed')) {
                                item.style.display = 'none';
                            } else if (status === 'downloading' && (action === 'start' || action === 'delete-completed')) {
                                item.style.display = 'none';
                            } else if (status === 'failed' && (action === 'pause' || action === 'delete-completed')) {
                                item.style.display = 'none';
                            } else {
                                item.style.display = 'block';
                            }
                        });
                    });
                });
                
                // 点击其他地方隐藏菜单
                document.addEventListener('click', function() {
                    taskMenu.style.display = 'none';
                });
                
                // 菜单点击事件
                const menuItems = taskMenu.querySelectorAll('.task-menu-item');
                menuItems.forEach(item => {
                    item.addEventListener('click', function() {
                        const action = this.getAttribute('data-action');
                        console.log(`执行操作: ${action}`);
                        taskMenu.style.display = 'none';
                    });
                });
            }
            
            // 拖拽功能
            const draggableItems = document.querySelectorAll('.draggable');
            let draggedItem = null;
            
            draggableItems.forEach(item => {
                item.addEventListener('dragstart', function() {
                    draggedItem = this;
                    setTimeout(() => {
                        this.classList.add('dragging');
                    }, 0);
                });
                
                item.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    draggedItem = null;
                });
                
                // 阻止默认的拖拽行为
                item.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });
                
                item.addEventListener('dragenter', function(e) {
                    e.preventDefault();
                    if (this !== draggedItem) {
                        this.classList.add('creator-table-row-dragging');
                    }
                });
                
                item.addEventListener('dragleave', function() {
                    if (this !== draggedItem) {
                        this.classList.remove('creator-table-row-dragging');
                    }
                });
                
                item.addEventListener('drop', function(e) {
                    e.preventDefault();
                    if (this !== draggedItem) {
                        // 获取两个元素的父容器
                        const parent = this.parentNode;
                        const draggedIndex = Array.from(parent.children).indexOf(draggedItem);
                        const thisIndex = Array.from(parent.children).indexOf(this);
                        
                        // 根据位置插入
                        if (draggedIndex < thisIndex) {
                            parent.insertBefore(draggedItem, this.nextSibling);
                        } else {
                            parent.insertBefore(draggedItem, this);
                        }
                    }
                    
                    // 移除拖拽样式
                    draggableItems.forEach(item => {
                        item.classList.remove('creator-table-row-dragging');
                    });
                });
            });
            
            // 窗口调整大小功能
            const resizeHandle = document.querySelector('.resize-handle');
            const mainWindow = document.getElementById('mainWindow');
            
            if (resizeHandle && mainWindow) {
                let isResizing = false;
                
                resizeHandle.addEventListener('mousedown', function(e) {
                    isResizing = true;
                    document.body.style.cursor = 'nwse-resize';
                    e.preventDefault();
                });
                
                document.addEventListener('mousemove', function(e) {
                    if (!isResizing) return;
                    
                    // 获取窗口当前位置和大小
                    const rect = mainWindow.getBoundingClientRect();
                    
                    // 计算新的宽度和高度
                    const newWidth = e.clientX - rect.left;
                    const newHeight = e.clientY - rect.top;
                    
                    // 设置最小尺寸
                    if (newWidth >= 600) {
                        mainWindow.style.width = `${newWidth}px`;
                    }
                    
                    if (newHeight >= 400) {
                        mainWindow.style.height = `${newHeight}px`;
                    }
                });
                
                document.addEventListener('mouseup', function() {
                    isResizing = false;
                    document.body.style.cursor = '';
                });
            }
            
            // 顶部导航标签切换
            const tabs = ['historyBtn', 'creatorBtn', 'settingsBtn'];
            
            tabs.forEach(tabId => {
                const tab = document.getElementById(tabId);
                if (tab) {
                    tab.addEventListener('click', function() {
                        // 移除所有标签的活动状态
                        tabs.forEach(id => {
                            document.getElementById(id).classList.remove('btn-tab-active');
                        });
                        
                        // 添加当前标签的活动状态
                        this.classList.add('btn-tab-active');
                    });
                }
            });
        });
    </script>

    <script>
        // JavaScript Bridge for Python communication
        let bridge = null;
        let isConnected = false;
        
        // Initialize bridge connection
        function initBridge() {
            new QWebChannel(qt.webChannelTransport, function(channel) {
                bridge = channel.objects.bridge;
                isConnected = true;
                console.log('Bridge connected successfully');
                
                // Connect Python signals to JavaScript functions
                bridge.task_added.connect(onTaskAdded);
                bridge.task_updated.connect(onTaskUpdated);
                bridge.task_completed.connect(onTaskCompleted);
                bridge.task_failed.connect(onTaskFailed);
                bridge.creator_added.connect(onCreatorAdded);
                bridge.creator_updated.connect(onCreatorUpdated);
                bridge.settings_updated.connect(onSettingsUpdated);
                
                // Load initial data
                loadInitialData();
            });
        }
        
        // Load initial data from Python
        function loadInitialData() {
            if (!bridge) return;
            
            // Load app info
            bridge.getAppInfo(function(info) {
                const data = JSON.parse(info);
                updateAppInfo(data);
            });
            
            // Load download settings
            bridge.getDownloadSettings(function(settings) {
                const data = JSON.parse(settings);
                updateDownloadSettings(data);
            });
            
            // Load network settings
            bridge.getNetworkSettings(function(settings) {
                const data = JSON.parse(settings);
                updateNetworkSettings(data);
            });
            
            // Load existing tasks
            bridge.getAllTasks(function(tasks) {
                const data = JSON.parse(tasks);
                updateTaskList(data);
            });
            
            // Load creators
            bridge.getAllCreators(function(creators) {
                const data = JSON.parse(creators);
                updateCreatorList(data);
            });
        }
        
        // Python signal handlers
        function onTaskAdded(url, taskData) {
            console.log('Task added:', url, taskData);
            addTaskToUI(url, taskData);
        }
        
        function onTaskUpdated(url, taskData) {
            console.log('Task updated:', url, taskData);
            updateTaskInUI(url, taskData);
        }
        
        function onTaskCompleted(url, filepath) {
            console.log('Task completed:', url, filepath);
            markTaskCompleted(url, filepath);
        }
        
        function onTaskFailed(url, error) {
            console.log('Task failed:', url, error);
            markTaskFailed(url, error);
        }
        
        function onCreatorAdded(creatorUrl, creatorInfo) {
            console.log('Creator added:', creatorUrl, creatorInfo);
            addCreatorToUI(creatorUrl, creatorInfo);
        }
        
        function onCreatorUpdated(creatorUrl, creatorInfo) {
            console.log('Creator updated:', creatorUrl, creatorInfo);
            updateCreatorInUI(creatorUrl, creatorInfo);
        }
        
        function onSettingsUpdated(section, settings) {
            console.log('Settings updated:', section, settings);
            updateSettingsInUI(section, settings);
        }
        
        // UI update functions
        function updateAppInfo(data) {
            // Update app info display
            console.log('App info:', data);
        }
        
        function updateDownloadSettings(data) {
            // Update download settings in UI
            console.log('Download settings:', data);
        }
        
        function updateNetworkSettings(data) {
            // Update network settings in UI
            console.log('Network settings:', data);
        }
        
        function updateTaskList(tasks) {
            // Update task list display
            console.log('Tasks:', tasks);
        }
        
        function updateCreatorList(creators) {
            // Update creator list display
            console.log('Creators:', creators);
        }
        
        function addTaskToUI(url, taskData) {
            // Add new task to UI
            console.log('Adding task to UI:', url, taskData);
        }
        
        function updateTaskInUI(url, taskData) {
            // Update existing task in UI
            console.log('Updating task in UI:', url, taskData);
        }
        
        function markTaskCompleted(url, filepath) {
            // Mark task as completed in UI
            console.log('Task completed in UI:', url, filepath);
        }
        
        function markTaskFailed(url, error) {
            // Mark task as failed in UI
            console.log('Task failed in UI:', url, error);
        }
        
        function addCreatorToUI(creatorUrl, creatorInfo) {
            // Add creator to UI
            console.log('Adding creator to UI:', creatorUrl, creatorInfo);
        }
        
        function updateCreatorInUI(creatorUrl, creatorInfo) {
            // Update creator in UI
            console.log('Updating creator in UI:', creatorUrl, creatorInfo);
        }
        
        function updateSettingsInUI(section, settings) {
            // Update settings in UI
            console.log('Updating settings in UI:', section, settings);
        }
        
        // API functions for UI to call Python
        function addDownload(url) {
            if (bridge && url) {
                return bridge.addDownload(url);
            }
            return false;
        }
        
        function cancelDownload(url) {
            if (bridge && url) {
                return bridge.cancelDownload(url);
            }
            return false;
        }
        
        function clearCompleted() {
            if (bridge) {
                bridge.clearCompleted();
            }
        }
        
        function addCreator(url, autoDownload = false) {
            if (bridge && url) {
                return bridge.addCreator(url, autoDownload);
            }
            return false;
        }
        
        function removeCreator(url) {
            if (bridge && url) {
                return bridge.removeCreator(url);
            }
            return false;
        }
        
        function updateDownloadSetting(key, value) {
            if (bridge) {
                bridge.updateDownloadSettings(key, value);
            }
        }
        
        function updateNetworkSetting(key, value) {
            if (bridge) {
                bridge.updateNetworkSettings(key, value);
            }
        }
        
        // Initialize bridge when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing bridge...');
            if (typeof QWebChannel !== 'undefined') {
                initBridge();
            } else {
                console.log('QWebChannel not available, running in standalone mode');
            }
        });
        
        // Enhanced UI interaction functions
        function handleAddDownload() {
            const input = document.querySelector('input[placeholder*="搜索视频或粘贴链接"]');
            if (input && input.value.trim()) {
                const url = input.value.trim();
                if (addDownload(url)) {
                    input.value = '';
                    console.log('Download added:', url);
                } else {
                    console.error('Failed to add download:', url);
                }
            }
        }
        
        function handleAddQueue() {
            // Handle batch download
            const urls = prompt('请输入多个视频链接，每行一个:');
            if (urls) {
                const urlList = urls.split('\n').filter(url => url.trim());
                urlList.forEach(url => {
                    if (url.trim()) {
                        addDownload(url.trim());
                    }
                });
            }
        }
        
        // Bind events to existing buttons
        document.addEventListener('DOMContentLoaded', function() {
            // Bind add download button
            const addBtn = document.querySelector('button:contains("添加下载")');
            if (addBtn) {
                addBtn.addEventListener('click', handleAddDownload);
            }
            
            // Bind add queue button
            const queueBtn = document.querySelector('button:contains("添加队列")');
            if (queueBtn) {
                queueBtn.addEventListener('click', handleAddQueue);
            }
            
            // Bind enter key in search input
            const searchInput = document.querySelector('input[placeholder*="搜索视频或粘贴链接"]');
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        handleAddDownload();
                    }
                });
            }
        });
    </script>
</body>
</html>    